import{r as i,j as e,aR as G,af as N,aS as P,aQ as f,aT as w,aU as H,aV as W,aW as o,aX as X,aY as J,E as C,ak as Z}from"./vendor-07012f45.js";import{g as S,n as ee,f as te,e as se,o as E,p as v,q as r,s as ae,t as l,v as m,c,w as re,x as ie,y as ne,z as le,B as ce,C as oe,D as de,k as b,l as A,E as xe,F as he,G as pe}from"./index-fadb8960.js";const I=i.memo(({defaultValue:a,placeholder:d,style:x,options:p,...n})=>e.jsx(G,{placeholder:d,defaultValue:a,style:x,options:p,allowClear:!0,...n})),ue=i.memo(({products:a,isLoading:d})=>{const[x,p]=i.useState(1),n=S(t=>t.category.category),{seri:M}=i.useContext(ee)||[],{user:j}=i.useContext(te),[k,D]=i.useState(""),[h,u]=i.useState(!1),[y,T]=i.useState([]),g=se();i.useEffect(()=>{g(E(x))},[h]);const O=t=>{g(ie(t))},F=t=>{g(ne(t))},V=t=>{p(t),g(E(t))};k&&(a=a.data.filter(t=>t.isApproved==!1),k=="Select"&&a.data.map(t=>a==null?void 0:a.data.push(t)));const R=async()=>{(await le(y)).data.success==!0?(u(!h),o.success("Delete products successfully")):o.error("Error deleting products")},L=async()=>{(await ce(y)).data.success==!0?(u(!h),o.success("Approved Products Successfully")):o.error("Error deleting products")},z=async()=>{(await oe(y)).data.success==!0?(u(!h),o.success("Edit Products Successfully")):o.error("Error deleting products")},Y=async t=>{(await g(xe(t))).payload.success?o.success("Delete product successfully"):o.error("Error deleting product")},B=t=>{D(t)},_={selectedRowKeys:y,onChange:t=>{T(t)}},K=async t=>{const s=await he(t);s.data.success==!0?(b(s.data.message),u(!h)):A("Lỗi rồi!")},Q=async t=>{const s=await pe(t);s.data.success==!0?(b(s.data.message),u(!h)):A("Lỗi rồi!")},U=async()=>{const t=await de();t.data.suscess==!0?b(t.data.message):A(t.data.message)},$=[{title:"Name",dataIndex:"name",key:"name",width:120},{title:"Slug",dataIndex:"slug",key:"slug",width:200},{title:"Category",key:"category",dataIndex:"category",width:150},{title:"View",key:"view",dataIndex:"view",width:100},{title:"Seri",key:"seri",dataIndex:"seri",width:100},{title:"Copyright",key:"copyright",dataIndex:"copyright",width:100},{title:"Active",dataIndex:"isActive",key:"isActive",width:90},{title:"Trailer",dataIndex:"trailer",key:"trailer",width:100},{title:"Country",dataIndex:"country",key:"country",width:100},{title:"Year",dataIndex:"year",key:"year",width:100},{title:"Options",dataIndex:"options",key:"options",width:100},{title:"Sidebar",key:"sidebar",dataIndex:"sidebar",width:100},{title:"Action",key:"action",dataIndex:"action",width:140,fixed:"right",render:(t,s)=>{switch(j==null?void 0:j.role){case 0:return e.jsx(e.Fragment,{children:e.jsx(c,{to:"/",children:e.jsx(r,{type:"text",shape:"circle",children:e.jsx(C,{})})})});case 1:return e.jsxs(e.Fragment,{children:[e.jsx(c,{to:"/",children:e.jsx(r,{type:"text",shape:"circle",children:e.jsx(C,{})})}),e.jsx(c,{to:`/dashboard/product/edit/${s.key}`,children:e.jsx(r,{type:"text",danger:!0,shape:"circle",children:e.jsx(f,{})})})]});case 2:return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.isApproved)==!0?e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"flex items-center mb-2",icon:e.jsx(P,{}),ghost:!0,type:"text",style:{color:"#000"},disabled:s.isApproved==!0,children:"Approved"}),e.jsx(r,{onClick:()=>Q(s.key),icon:e.jsx(X,{}),className:"flex items-center w-full justify-center mb-2",danger:!0,children:"Approval"})]}):e.jsx(e.Fragment,{children:e.jsx(r,{onClick:()=>K(s.key),icon:e.jsx(J,{}),className:"flex items-center w-full justify-center text-white bg-blue-500",children:"Approve"})}),e.jsxs("div",{className:"flex",children:[e.jsx(c,{to:"/d/"+s.slug,children:e.jsx(r,{type:"text",shape:"circle",children:e.jsx(C,{})})}),e.jsx(c,{to:`/dashboard/product/edit/${s.slug}`,children:e.jsx(r,{type:"text",danger:!0,shape:"circle",children:e.jsx(f,{})})}),e.jsx(m,{title:"Delete the product",onConfirm:()=>Y(s.key),okText:"Yes",cancelText:"No",children:e.jsx(r,{type:"text",shape:"circle",className:"ml-2",children:e.jsx(N,{})})}),e.jsx(r,{type:"text",shape:"circle",className:"ml-2",children:e.jsx(Z,{type:"success"})})]})]})}}}],q=(a==null?void 0:a.data)&&(a==null?void 0:a.data.map(t=>({key:t._id,name:t.name,slug:t.slug,trailer:t.trailer?"true":"false",category:t.category.name,view:e.jsx(v,{color:"#2db7f5",children:t.view}),sidebar:M&&M.map((s,ye)=>s._id===t.typeId&&s.name),seri:t.seri,copyright:t.copyright,isActive:t.server2||t.dailyMotionServer?e.jsx(v,{color:"success",children:"Video active"}):e.jsx(v,{color:"error",children:"No video"}),options:t.category.lang,country:t.category.country?t.category.country:"null",year:t.category.year?t.category.year:"null",isApproved:t.isApproved,idCategory:t.category,option:[e.jsx(r,{children:"Add Option"})]})));return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{gutter:[10,10],align:"middle",style:{marginBottom:"10px"},children:[e.jsx(l,{children:e.jsx(m,{title:"Delete The Movies",onConfirm:R,okText:"Yes",cancelText:"No",children:e.jsx(r,{icon:e.jsx(N,{}),className:"flex items-center bg-gradient-to-br from-pink-500 to-orange-400 text-white",children:"Delete Multiple Movies"})})}),e.jsx(m,{title:"Approved Multiple Movies",onConfirm:L,okText:"Yes",cancelText:"No",children:e.jsx(r,{icon:e.jsx(P,{}),className:"flex items-center bg-amber-500 text-white",children:"Approved Multiple"})}),e.jsx(m,{title:"Edit Multiple Movies",onConfirm:z,okText:"Yes",cancelText:"No",children:e.jsx(r,{icon:e.jsx(f,{}),className:"flex items-center mx-2 bg-gradient-to-br from-purple-600 to-blue-500 text-white",children:"Edit Multiple"})}),e.jsx(l,{children:e.jsx(c,{to:"/dashboard/product/add",children:e.jsx(r,{icon:e.jsx(w,{}),className:"flex items-center text-white bg-blue-500",children:"Add Movie"})})}),e.jsx(l,{children:e.jsx(c,{icon:e.jsx(w,{}),to:"/dashboard/product/creacting",children:e.jsx(r,{className:"bg-green-400 ",children:"Add Multiple Movies"})})}),e.jsx(l,{children:e.jsx(c,{to:"/dashboard/product/add",children:e.jsx(r,{className:"bg-yellow-400",children:"Export PDF"})})}),e.jsx(l,{children:e.jsx(c,{to:"/dashboard/product/add",children:e.jsx(r,{className:"bg-purple-500",shape:"round",children:"Export Excel"})})}),e.jsx(l,{children:e.jsx(I,{placeholder:"Category",onChange:O,style:{width:300},options:n&&(n==null?void 0:n.data.map((t,s)=>({label:t.name,value:t._id})))})}),e.jsx(l,{children:e.jsx(I,{placeholder:"Approval",onChange:B,style:{width:300},options:[{value:!0,label:"Approve"},{value:!1,label:"Approved"}],children:void 0})}),e.jsx(l,{children:e.jsx("div",{className:"form-outline",children:e.jsx("input",{type:"search",placeholder:"search...",className:"form-control p-2 rounded bg-[#fff] shadow-sm",onChange:t=>F(t.target.value)})})}),e.jsx(l,{children:e.jsxs(r,{onClick:()=>U(),icon:e.jsx(w,{}),danger:!0,className:"flex items-center",children:[e.jsx(H,{}),"Clear Products Redis"]})})]}),e.jsx(W,{spinning:d,delay:void 0,children:e.jsx(re,{rowSelection:_,expandable:{expandedRowRender:t=>e.jsx(e.Fragment,{children:t.option})},columns:$,dataSource:q,scroll:{x:1500,y:1e3},pagination:{defaultPageSize:40,showSizeChanger:!0,pageSizeOptions:["40","80","120"],current:x,onChange:V,total:a==null?void 0:a.totalCount}})})]})}),fe=()=>{const a=S(n=>n.product.value),d=S(n=>n.product.isLoading),x=i.useMemo(()=>a,[a]),p=i.useMemo(()=>d,[d]);return e.jsx(e.Fragment,{children:e.jsx(ue,{products:x,isLoading:p})})};export{fe as default};
