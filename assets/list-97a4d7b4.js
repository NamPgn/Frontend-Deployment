import{r as i,j as e,aS as $,ag as b,aT as m,aU as q,aV as H,aW as y,aX as Q,aY as W,aZ as X,E as g,aR as P,al as Z}from"./vendor-5f4444f9.js";import{g as A,n as G,f as J,e as ee,o as N,p as f,q as n,s as te,t as c,v as M,c as l,w as se,x as ae,y as ne,z as re,B as ie,k as C,l as w,C as ce,D as le,E as de}from"./index-610e44f6.js";const I=i.memo(({defaultValue:a,placeholder:d,style:o,options:h,...r})=>e.jsx($,{placeholder:d,defaultValue:a,style:o,options:h,allowClear:!0,...r})),oe=i.memo(({products:a,isLoading:d})=>{const[o,h]=i.useState(1),r=A(t=>t.category.category),{seri:S}=i.useContext(G)||[],{user:u}=i.useContext(J),[k,E]=i.useState(""),[p,j]=i.useState(!1),[v,D]=i.useState([]),x=ee();i.useEffect(()=>{x(N(o))},[p]);const O=t=>{x(ae(t))},V=t=>{x(ne(t))},F=t=>{h(t),x(N(t))};k&&(a=a.data.filter(t=>t.isApproved==!1),k=="Select"&&a.data.map(t=>a==null?void 0:a.data.push(t)));const R=async()=>{(await re(v)).data.success==!0?(j(!p),y.success("Delete products successfully")):y.error("Error deleting products")},T=async t=>{(await x(ce(t))).payload.success?y.success("Delete product successfully"):y.error("Error deleting product")},L=t=>{E(t)},z={selectedRowKeys:v,onChange:t=>{D(t)}},_=async t=>{const s=await le(t);s.data.success==!0?(C(s.data.message),j(!p)):w("Lỗi rồi!")},B=async t=>{const s=await de(t);s.data.success==!0?(C(s.data.message),j(!p)):w("Lỗi rồi!")},Y=async()=>{const t=await ie();t.data.suscess==!0?C(t.data.message):w(t.data.message)},K=[{title:"Name",dataIndex:"name",key:"name",width:200},{title:"Category",key:"category",dataIndex:"category",width:200},{title:"View",key:"view",dataIndex:"view",width:100},{title:"Seri",key:"seri",dataIndex:"seri",width:100},{title:"Copyright",key:"copyright",dataIndex:"copyright",width:100},{title:"Active",dataIndex:"isActive",key:"isActive",width:90},{title:"Trailer",dataIndex:"trailer",key:"trailer",width:100},{title:"Country",dataIndex:"country",key:"country",width:100},{title:"Year",dataIndex:"year",key:"year",width:100},{title:"Options",dataIndex:"options",key:"options",width:100},{title:"Sidebar",key:"sidebar",dataIndex:"sidebar",width:100},{title:"Action",key:"action",dataIndex:"action",width:140,fixed:"right",render:(t,s)=>{switch(u==null?void 0:u.role){case 0:return e.jsx(e.Fragment,{children:e.jsx(l,{to:"/",children:e.jsx(n,{type:"text",shape:"circle",children:e.jsx(g,{})})})});case 1:return e.jsxs(e.Fragment,{children:[e.jsx(l,{to:"/",children:e.jsx(n,{type:"text",shape:"circle",children:e.jsx(g,{})})}),e.jsx(l,{to:`/dashboard/product/edit/${s.key}`,children:e.jsx(n,{type:"text",danger:!0,shape:"circle",children:e.jsx(P,{})})})]});case 2:return e.jsxs(e.Fragment,{children:[(s==null?void 0:s.isApproved)==!0?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"flex items-center mb-2",icon:e.jsx(Q,{}),ghost:!0,type:"text",style:{color:"#000"},disabled:s.isApproved==!0,children:"Approved"}),e.jsx(n,{onClick:()=>B(s.key),icon:e.jsx(W,{}),className:"flex items-center w-full justify-center mb-2",danger:!0,children:"Approval"})]}):e.jsx(e.Fragment,{children:e.jsx(n,{onClick:()=>_(s.key),icon:e.jsx(X,{}),className:"flex items-center w-full justify-center",type:"primary",children:"Approve"})}),e.jsxs("div",{className:"flex",children:[e.jsx(l,{to:"/d/"+s.key+"?c="+s.idCategory,children:e.jsx(n,{type:"text",shape:"circle",children:e.jsx(g,{})})}),e.jsx(l,{to:`/dashboard/product/edit/${s.key}`,children:e.jsx(n,{type:"text",danger:!0,shape:"circle",children:e.jsx(P,{})})}),e.jsx(M,{title:"Delete the product",onConfirm:()=>T(s.key),okText:"Yes",cancelText:"No",children:e.jsx(n,{type:"text",shape:"circle",className:"ml-2",children:e.jsx(b,{})})}),e.jsx(n,{type:"text",shape:"circle",className:"ml-2",children:e.jsx(Z,{type:"success"})})]})]})}}}],U=(a==null?void 0:a.data)&&(a==null?void 0:a.data.map(t=>({key:t._id,name:t.name,trailer:t.trailer?"true":"false",category:r&&r.data.map(s=>{if(s._id===t.category)return s.name}),view:e.jsx(f,{color:"#2db7f5",children:t.view}),sidebar:S&&S.map((s,xe)=>s._id===t.typeId&&s.name),seri:t.seri,copyright:t.copyright,isActive:t.server2||t.dailyMotionServer?e.jsx(f,{color:"success",children:"Video active"}):e.jsx(f,{color:"error",children:"No video"}),options:t.options,country:t.country?t.country:"null",year:t.year?t.year:"null",isApproved:t.isApproved,idCategory:t.category,option:[e.jsx(n,{children:"Add Option"})]})));return e.jsxs(e.Fragment,{children:[e.jsxs(te,{gutter:[10,10],align:"middle",style:{marginBottom:"10px"},children:[e.jsx(c,{children:e.jsx(M,{title:"Delete the products",onConfirm:R,okText:"Yes",cancelText:"No",children:e.jsx(n,{icon:e.jsx(b,{}),className:"flex items-center",children:"Delete"})})}),e.jsx(c,{children:e.jsx(l,{to:"/dashboard/product/add",children:e.jsx(n,{icon:e.jsx(m,{}),type:"primary",className:"flex items-center",children:"Add Product"})})}),e.jsx(c,{children:e.jsx(l,{icon:e.jsx(m,{}),to:"/dashboard/product/creacting",children:e.jsx(n,{className:"bg-green-400 ",children:"Add Multiple"})})}),e.jsx(c,{children:e.jsx(l,{to:"/dashboard/product/add",children:e.jsx(n,{className:"bg-yellow-400",children:"Export PDF"})})}),e.jsx(c,{children:e.jsx(l,{to:"/dashboard/product/add",children:e.jsx(n,{className:"bg-purple-500",shape:"round",children:"Export Excel"})})}),e.jsx(c,{children:e.jsx(I,{placeholder:"Category",onChange:O,style:{width:300},options:r&&(r==null?void 0:r.data.map((t,s)=>({label:t.name,value:t._id})))})}),e.jsx(c,{children:e.jsx(I,{placeholder:"Approval",onChange:L,style:{width:300},options:[{value:!0,label:"Approve"},{value:!1,label:"Approved"}],children:void 0})}),e.jsx(c,{children:e.jsx("div",{className:"form-outline",children:e.jsx("input",{type:"search",placeholder:"search...",className:"form-control p-2 rounded bg-[#fff] shadow-sm",onChange:t=>V(t.target.value)})})}),e.jsx(c,{children:e.jsxs(n,{onClick:()=>Y(),icon:e.jsx(m,{}),danger:!0,className:"flex items-center",children:[e.jsx(q,{}),"Clear Products Redis"]})})]}),e.jsx(H,{spinning:d,delay:void 0,children:e.jsx(se,{rowSelection:z,expandable:{expandedRowRender:t=>e.jsx(e.Fragment,{children:t.option})},columns:K,dataSource:U,scroll:{x:1500,y:1e3},pagination:{defaultPageSize:40,showSizeChanger:!0,pageSizeOptions:["40","80","120"],current:o,onChange:F,total:a==null?void 0:a.totalCount}})})]})}),ue=()=>{const a=A(r=>r.product.value),d=A(r=>r.product.isLoading),o=i.useMemo(()=>a,[a]),h=i.useMemo(()=>d,[d]);return e.jsx(e.Fragment,{children:e.jsx(oe,{products:o,isLoading:h})})};export{ue as default};
